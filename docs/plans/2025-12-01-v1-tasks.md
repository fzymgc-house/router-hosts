# router-hosts v1.0 Implementation Tasks

**Date:** 2025-12-01
**Last Updated:** 2025-12-08
**Status:** Active development - Client CLI complete, server features in progress
**Related:** [v1.0 Design Document](2025-12-01-router-hosts-v1-design.md)

> **Note:** Remaining tasks are tracked in GitHub Issues.
> Use `gh issue list` to see current work items.

## Current Status Summary

### Core Features
| Feature | Status | Notes |
|---------|--------|-------|
| Event store (DuckDB/CQRS) | ✅ Complete | 2025-11-30 |
| Host CRUD RPCs | ✅ Complete | Add/Get/Update/Delete/List/Search |
| Snapshot RPCs | ✅ Complete | Create/List/Rollback/Delete |
| Hosts file generation | ✅ Complete | Atomic writes |
| Post-edit hooks | ✅ Complete | Success/failure with timeout |
| mTLS authentication | ✅ Complete | Manual cert mode |
| Export RPC | ✅ Complete | PR #22, 2025-12-04 |
| Import RPC | ✅ Complete | PR #33, 2025-12-05 |
| Client CLI | ✅ Complete | PR #36, 2025-12-06 |
| E2E acceptance tests | ✅ Complete | PR #62, 2025-12-08 |

### E2E Test Status

| Test Scenario | Status | Notes |
|--------------|--------|-------|
| initial_setup | ✅ Passing | First-time deployment workflow |
| auth_failures (2 tests) | ✅ Passing | mTLS security boundary testing |
| search_and_filter | ✅ Passing | Host search functionality |
| crud_workflow | ⏸️ Ignored | Blocked on #70 (JSON output missing id) |
| import_export_roundtrip | ⏸️ Ignored | Blocked on #69 (clap type mismatch) |
| disaster_recovery (2 tests) | ⏸️ Ignored | Blocked on #71 (snapshot JSON output) |

### Remaining v1.0 Work

#### Medium Priority
| Task | Issue | Description |
|------|-------|-------------|
| Lazy streaming for export | #23 | Memory-efficient export for large datasets |
| Batch transaction optimization | #34 | Improve import performance |

#### Low Priority (Post-v1.0)
| Task | Issue | Description |
|------|-------|-------------|
| ACME support | #15 | Automatic certificate management |
| Event monitoring | #16 | Log warning at 100K events |
| CI security scanning | #29 | Add cargo audit |
| Coverage reporting | #25 | Add to CI |

### Client CLI Enhancements (Post-v1.0)
Issues created from PR #36 code review:
- #37: `--no-follow-symlinks` flag
- #38: Client-side stream limits
- #39: RAII env var cleanup in tests
- #40: TTY check for progress display
- #41: Consider dirs→directories migration
- #42: Document chunk size choice

### Documentation (Low Priority)
| Task | Issue | Description |
|------|-------|-------------|
| CSV format specs | #24 | Document field selection |
| Container deployment | #18 | Separate hosts file setup |
| ACME/mTLS interaction | #19 | Certificate management docs |
| Event compaction strategy | #20 | Document compaction approach |

## Completed

| Task | Completed | PR/Notes |
|------|-----------|----------|
| Design document | 2025-12-01 | docs/plans/2025-12-01-router-hosts-v1-design.md |
| Event store | 2025-11-30 | DuckDB with CQRS |
| Host CRUD RPCs | 2025-11-30 | Add/Get/Update/Delete/List/Search |
| Snapshot RPCs | 2025-11-30 | Create/List/Rollback/Delete |
| Hosts file generation | 2025-11-30 | Atomic writes |
| Hooks | 2025-11-30 | Success/failure with timeout |
| mTLS | 2025-11-30 | Manual cert mode |
| Proto alignment | 2025-12-01 | PR #7 - Version field, expected_version |
| CI pipeline | 2025-12-01 | GitHub Actions with lint/test/review |
| ExportHosts RPC | 2025-12-04 | PR #22 - hosts/json/csv formats |
| Integration tests | 2025-12-04 | PR #21 - gRPC integration tests |
| ImportHosts RPC | 2025-12-05 | PR #33 - Bidirectional streaming |
| Import conflict modes | 2025-12-05 | PR #33 - Skip/replace/strict modes |
| Client CLI | 2025-12-06 | PR #36 - Complete CLI with all commands |
| ULID versioning | 2025-12-07 | PR #50 - Store ULIDs as event versions |
| Version check on update | 2025-12-08 | PR #46 - Optimistic concurrency control |
| Interactive conflict handling | 2025-12-08 | PR #51 - CLI diff display with retry |
| Snapshot retention | 2025-12-08 | PR #53 - Enforce max_snapshots and max_age |
| Version conflict tests | 2025-12-08 | PR #55 - Integration tests for retry flow |
| RollbackToSnapshot | 2025-12-08 | Snapshot rollback with pre-rollback backup |
| Snapshot/hooks coverage | 2025-12-08 | PR #59 - Tests for snapshots and hooks |
| E2E testing infrastructure | 2025-12-08 | PR #62 - Docker + testcontainers + mTLS |
